<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>RepeatSeq Analyzer - 暗号文反復パターン可視化ツール</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>🔁 RepeatSeq Analyzer</h1>
    <p>暗号文の中にある反復文字列（3文字以上）を検出・可視化し、鍵長推定に活用します。</p>
  </header>

  <main>
    <section>
      <h2>🔤 暗号文の入力</h2>
      <div id="drop-zone" class="drop-zone">
        <p>📁 テキストファイルをここにドラッグ&ドロップ</p>
        <p class="drop-zone-or">または</p>
        <p class="drop-zone-click">クリックしてファイルを選択</p>
        <input type="file" id="file-input" accept=".txt,text/plain" style="display: none;">
      </div>
      <textarea id="ciphertext" rows="10" placeholder="ここに暗号文を貼り付けてください（英字）"></textarea>
      <div>
        <label><input type="checkbox" id="ignore-spaces" checked> 空白・記号を除去して処理</label>
      </div>
      <button id="analyze-btn">🔍 解析する</button>
    </section>

    <section>
      <h2>🖍 ハイライト結果</h2>
      <div id="highlighted-text" class="output-box">（ここにハイライト表示）</div>
    </section>

    <section>
      <h2>📋 検出された反復文字列</h2>
      <div id="filter-controls" class="filter-controls">
        <label class="filter-label">フィルター：</label>
        <div id="length-filters" class="length-filters">
          <!-- フィルターチェックボックスがここに動的に生成される -->
        </div>
        <button id="select-all-btn" class="filter-btn">全選択</button>
        <button id="clear-all-btn" class="filter-btn">全解除</button>
      </div>
      <div id="pagination-controls" style="display: none;">
        <button id="prev-page" disabled>◀ 前へ</button>
        <span id="page-info"></span>
        <button id="next-page">次へ ▶</button>
      </div>
      <table id="result-table">
        <thead>
          <tr>
            <th class="sortable" data-column="seq">文字列 <span class="sort-indicator"></span></th>
            <th class="sortable" data-column="len">長さ <span class="sort-indicator">▼</span></th>
            <th class="sortable" data-column="first">1回目位置 <span class="sort-indicator"></span></th>
            <th class="sortable" data-column="second">2回目位置 <span class="sort-indicator"></span></th>
            <th class="sortable" data-column="gap">間隔 <span class="sort-indicator"></span></th>
            <th>公約数（1除外）</th>
          </tr>
        </thead>
        <tbody>
          <!-- 検出結果がここに表示される -->
        </tbody>
      </table>
    </section>

    <section>
      <h2>🧠 鍵長の候補（推定）</h2>
      <div class="keylength-controls">
        <label class="toggle-label">
          <input type="checkbox" id="hide-short-keys" class="toggle-checkbox">
          <span class="toggle-slider"></span>
          鍵長3以下を非表示
        </label>
        <label class="toggle-label">
          <input type="checkbox" id="hide-long-keys" class="toggle-checkbox">
          <span class="toggle-slider"></span>
          鍵長20以上を非表示
        </label>
      </div>
      <div id="keylength-hints" class="output-box">（公約数に基づく候補がここに表示されます）</div>
      <div id="keylength-warning" class="warning-message" style="display: none;"></div>
    </section>
  </main>

  <footer>
    <div class="footer">
      🔗 GitHubリポジトリはこちら（ <a href="https://github.com/ipusiron/repeatseq-analyzer" target="_blank">ipusiron/repeatseq-analyzer</a> ）
    </div>
  </footer>

  <script src="script.js"></script>
</body>
</html>
